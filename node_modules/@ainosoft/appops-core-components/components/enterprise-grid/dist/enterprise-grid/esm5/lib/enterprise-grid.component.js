/**
 * @fileoverview added by tsickle
 * Generated from: lib/enterprise-grid.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Injectable, ViewChild } from '@angular/core';
import { CdkVirtualScrollViewport } from '@angular/cdk/scrolling';
import { BaseActionDispatcher } from '../action/BaseActionDispatcher';
import * as i0 from "@angular/core";
import * as i1 from "../action/BaseActionDispatcher";
var EnterpriseGridComponent = /** @class */ (function () {
    function EnterpriseGridComponent(baseActionDispatcher) {
        this.baseActionDispatcher = baseActionDispatcher;
        this.gridConfig = new Array();
        this.columnConfig = new Array();
        this.gridDataList = new Array();
        this.gridHeader = '';
        this.addNewUserForm = { enable: false, token: '' };
        this.enableActionToolbar = { enable: false, token: '' };
        this.enableSearchToolBar = { enable: false, token: '' };
        this.enableSearchPlaceholder = { enable: 'none', token: '' };
        this.enableSearchBar = { enable: 'none', token: '' };
        this.enableForm = { enable: false, token: '' };
        this.enablePaging = false;
    }
    /**
     * @return {?}
     */
    EnterpriseGridComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.columnConfig = [];
    };
    Object.defineProperty(EnterpriseGridComponent.prototype, "setGridData", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            this.gridDataList = data;
            this.createGrid();
            console.log(this.gridDataList, ' enterprise grid list received');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EnterpriseGridComponent.prototype, "setGridConfig", {
        set: /**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            console.log(data, ' enterprise grid config received');
            this.gridHeader = data[0];
            this.columnConfig = data[1];
            this.gridConfig = data[2][0];
            this.sortGridConfig(this.gridConfig);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * This method sorts the grid configuration.
     * @param gridConfig JSON object of grid configuration.
     */
    /**
     * This method sorts the grid configuration.
     * @param {?} gridConfig JSON object of grid configuration.
     * @return {?}
     */
    EnterpriseGridComponent.prototype.sortGridConfig = /**
     * This method sorts the grid configuration.
     * @param {?} gridConfig JSON object of grid configuration.
     * @return {?}
     */
    function (gridConfig) {
        /** @type {?} */
        var keys = Object.keys(gridConfig);
        /** @type {?} */
        var enterpGridCompKeys = Object.getOwnPropertyNames(this);
        for (var i = 0; i < keys.length; i++) {
            for (var j = 0; j < enterpGridCompKeys.length; j++) {
                if (keys[i] === enterpGridCompKeys[j]) {
                    this[enterpGridCompKeys[j]]['enable'] = this.gridConfig[keys[i]]['enable'];
                    this[enterpGridCompKeys[j]]['token'] = this.gridConfig[keys[i]]['token'];
                }
            }
        }
    };
    /**
     * @return {?}
     */
    EnterpriseGridComponent.prototype.setWidthByColumn = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var count = 100 / this.columnConfig.length;
        // console.log(count);
        return count;
    };
    /** Creates grid rows and add styles */
    /**
     * Creates grid rows and add styles
     * @return {?}
     */
    EnterpriseGridComponent.prototype.createRows = /**
     * Creates grid rows and add styles
     * @return {?}
     */
    function () {
        this.row = document.createElement('tr');
        this.row.style.background = 'white';
        this.row.style.padding = '5px';
        this.row.classList.add("table-row-data");
        this.cdkVirtualViewport.appendChild(this.row);
        this.styleCells();
    };
    /** Creates grid cells and add styles */
    /**
     * Creates grid cells and add styles
     * @return {?}
     */
    EnterpriseGridComponent.prototype.styleCells = /**
     * Creates grid cells and add styles
     * @return {?}
     */
    function () {
        for (var i = 0; i < this.columnConfig.length; i++) {
            this.tdElement = document.createElement('td');
            this.tdElement.style.paddingTop = '10px';
            this.tdElement.style.paddingBottom = '10px';
            this.tdElement.style.padding = '10px';
            this.tdElement.style.textAlign = 'left';
            this.tdElement.style.borderBottom = '1px solid #ddd';
            this.tdElement.style.fontFamily = '"Questrial", sans-serif';
            this.tdElement.style.border = 'none';
            this.tdElement.style.outline = 'none';
            this.tdElement.style.height = '39px';
            this.tdElement.style.width = this.setWidthByColumn() + '%';
            this.row.appendChild(this.tdElement);
        }
    };
    /**
     * Create table heading
     */
    /**
     * Create table heading
     * @return {?}
     */
    EnterpriseGridComponent.prototype.createTableHeading = /**
     * Create table heading
     * @return {?}
     */
    function () {
        /** @type {?} */
        var tableHeadDiv = (/** @type {?} */ (document.getElementsByClassName("th-div")[0]));
        if (tableHeadDiv.childElementCount == 0) {
            for (var i = 0; i < this.columnConfig.length; i++) {
                this.thElement = document.createElement('th');
                this.thElement.style.padding = '10px';
                this.thElement.style.textAlign = 'left';
                this.thElement.style.borderBottom = '1px solid #ddd';
                this.thElement.style.fontFamily = '"Questrial", sans-serif';
                this.thElement.style.border = 'none';
                this.thElement.style.outline = 'none';
                this.thElement.style.fontSize = '14px';
                this.thElement.style.letterSpacing = '1px';
                this.thElement.style.height = '16px';
                this.thElement.style.color = 'rgba(0,0,0,.54)';
                // this.thElement.whiteSpace = 'nowrap';
                this.thElement.style.width = this.setWidthByColumn() + '%';
                if (this.columnConfig[i].name === 'checkbox') {
                    this.createCheckbox();
                    this.checkbox.style.marginTop = '0px';
                    this.thElement.appendChild(this.checkbox);
                }
                else {
                    /** @type {?} */
                    var headName = this.columnConfig[i].name;
                    this.thElement.innerHTML = this.columnConfig[i].item;
                    this.thElement.classList.add(headName);
                }
                tableHeadDiv.appendChild(this.thElement);
            }
        }
    };
    /**
     * @return {?}
     */
    EnterpriseGridComponent.prototype.createCheckbox = /**
     * @return {?}
     */
    function () {
        this.checkbox = document.createElement("INPUT");
        this.checkbox.setAttribute("type", "checkbox");
        this.checkbox.classList.add('checkbox');
        this.checkbox.style.transition = 'background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1)';
        this.checkbox.style.cursor = 'pointer';
        this.checkbox.style.height = '16px';
        this.checkbox.style.margin = '6px';
        this.checkbox.style.width = '16px';
        this.checkbox.style.marginLeft = '17px';
    };
    /** Creates the rows and columns of the grid according to column defs and module data list */
    /**
     * Creates the rows and columns of the grid according to column defs and module data list
     * @return {?}
     */
    EnterpriseGridComponent.prototype.createGrid = /**
     * Creates the rows and columns of the grid according to column defs and module data list
     * @return {?}
     */
    function () {
        console.log('create grid');
        this.cdkVirtualViewport = document.getElementsByClassName('cdk-virtual-scroll-content-wrapper')[0];
        this.cdkVirtualViewport.style.display = 'inline-table';
        //Create table heading
        this.createTableHeading();
        for (var i = 0; i < this.gridDataList.length; i++) {
            this.createRows();
            this.createCheckbox();
            for (var moduleListKey in this.gridDataList[i]) {
                for (var columnConfigKey in this.columnConfig) {
                    if (this.columnConfig[columnConfigKey].name === moduleListKey) {
                        /** @type {?} */
                        var table = document.getElementsByClassName("table-row-data");
                        /** @type {?} */
                        var lastRowIndex = table.length;
                        /** @type {?} */
                        var tableRowData = (/** @type {?} */ (document.getElementsByClassName('table-row-data')[lastRowIndex - 1]));
                        /** @type {?} */
                        var tableDataCell = tableRowData.cells;
                        /** @type {?} */
                        var pos = this.columnConfig[columnConfigKey].position;
                        /** @type {?} */
                        var value = this.gridDataList[i][moduleListKey];
                        tableDataCell[0].appendChild(this.checkbox);
                        tableDataCell[pos].innerHTML = value;
                    }
                }
            }
        }
    };
    /** Search filteration by name
     *  (Still in progress)
     */
    /**
     * Search filteration by name
     *  (Still in progress)
     * @param {?} data
     * @return {?}
     */
    EnterpriseGridComponent.prototype.searchByName = /**
     * Search filteration by name
     *  (Still in progress)
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.gridDataList = [];
        for (var i = 0; i < this.gridDataList.length; i++) {
            if (this.gridDataList[i].firstName.includes(data)) {
                this.gridDataList.push(this.gridDataList[i]);
            }
        }
    };
    /**
     * @param {?} a
     * @return {?}
     */
    EnterpriseGridComponent.prototype.getNextBatchOfImages = /**
     * @param {?} a
     * @return {?}
     */
    function (a) {
        if (this.virtualScroll.measureScrollOffset('bottom') === 0) {
        }
    };
    /**
     * Forward the event to dispatch action with tokens and parameters.
     */
    /**
     * Forward the event to dispatch action with tokens and parameters.
     * @param {?} token
     * @return {?}
     */
    EnterpriseGridComponent.prototype.addNewUserFormAction = /**
     * Forward the event to dispatch action with tokens and parameters.
     * @param {?} token
     * @return {?}
     */
    function (token) {
        this.baseActionDispatcher.dispatchAction(token);
    };
    /** Toggles from search placeholder to search bar/box by setting the display value */
    /**
     * Toggles from search placeholder to search bar/box by setting the display value
     * @param {?} action
     * @return {?}
     */
    EnterpriseGridComponent.prototype.toggleToSearchBar = /**
     * Toggles from search placeholder to search bar/box by setting the display value
     * @param {?} action
     * @return {?}
     */
    function (action) {
        this.baseActionDispatcher.dispatchAction(action);
    };
    EnterpriseGridComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ao-enterprise-grid',
                    template: "<div class=\"gridBgColor enterp-grid-container\">\r\n    <mat-toolbar class=\"gridBgColor action-bar\" *ngIf=\"enableActionToolbar.enable\">\r\n        <h2>{{gridHeader}} | </h2>\r\n        <span> Showing all {{gridHeader + 's' | lowercase}}</span>\r\n\r\n        <button mat-button class=\"action-button\" *ngIf=\"addNewUserForm.enable\"\r\n            (click)=\"addNewUserFormAction(addNewUserForm.token)\" matTooltip=\"Add new {{gridHeader | lowercase}}\">\r\n            Add new {{gridHeader | lowercase}}\r\n        </button>\r\n\r\n        <button mat-button [matMenuTriggerFor]=\"afterMenu\" class=\"action-button\" matTooltip=\"more actions\">More\r\n            <mat-icon>arrow_drop_down</mat-icon>\r\n        </button>\r\n        <mat-menu #afterMenu=\"matMenu\" xPosition=\"after\">\r\n            <button mat-menu-item>{{gridHeader | lowercase}} meta config</button>\r\n        </mat-menu>\r\n\r\n    </mat-toolbar>\r\n    <mat-toolbar class=\"search-toolbar\" *ngIf=\"enableSearchToolBar.enable\">\r\n\r\n        <div class=\"search-placeholder\" *ngIf=\"enableSearchPlaceholder.enable\">\r\n            <button mat-button class=\"filter-button\" (click)='toggleToSearchBar(enableSearchPlaceholder.token)'>\r\n                <mat-icon>add</mat-icon> Add a filter\r\n            </button>\r\n        </div>\r\n        <mat-form-field class=\"search-field\" *ngIf=\"enableSearchBar.enable\">\r\n            <input type=\"text\" class=\"search-input\" matInput placeholder=\"search\" [ngModel]=\"filterValue\"\r\n                (ngModelChange)=\"filterValue=searchByName(filterValue)\">\r\n        </mat-form-field>\r\n\r\n    </mat-toolbar>\r\n\r\n    <div class='table-card'>\r\n        <div class=\"th-div\">\r\n\r\n        </div>\r\n\r\n        <cdk-virtual-scroll-viewport CdkScrollable itemSize=\"1\" id=\"example-viewport1\"\r\n            (scroll)='getNextBatchOfImages(\"Approved\")'>\r\n\r\n        </cdk-virtual-scroll-viewport>\r\n    </div>\r\n\r\n    <mat-toolbar class=\"footer\">\r\n        <p>Ainosoft \u00A92017 All rights reserved</p>\r\n    </mat-toolbar>\r\n\r\n</div>",
                    styles: [".gridBgColor{background:#f0f1f3}.search-toolbar{background:#fff}span{font-weight:100;color:rgba(0,0,0,.54);font-size:15px;margin-left:2px}h2{margin-left:5px;color:#414c55;font-family:Questrial,sans-serif;font-weight:700;letter-spacing:1px}.mat-toolbar-row,.mat-toolbar-single-row{height:55px}.filter-button{border:1px dashed rgba(0,0,0,.26);border-radius:34px;-webkit-transition:opacity .1s cubic-bezier(.4,0,.2,1);transition:opacity .1s cubic-bezier(.4,0,.2,1);color:rgba(0,0,0,.54)}.action-button{color:#3367d6}tr:hover{background:rgba(18,154,144,.08);-webkit-transition:270ms ease-in-out;transition:270ms ease-in-out}*{word-wrap:break-word;border-spacing:0 5px}.table-card{padding:11px}.th-div{display:-webkit-box;display:flex;width:95%}#example-viewport1{height:58vh;width:100%}.checkbox{display:inline-block;height:16px;line-height:0;margin:auto 8px auto auto;-webkit-box-ordinal-group:1;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}.card{padding:8px;-webkit-animation:.5s cubic-bezier(.25,.46,.45,.94) both slide-table;animation:.5s cubic-bezier(.25,.46,.45,.94) both slide-table}@-webkit-keyframes slide-table{from{-webkit-transform:translateX(150px);transform:translateX(150px)}to{-webkit-transform:translateX(5px);transform:translateX(5px)}}@keyframes slide-table{from{-webkit-transform:translateX(150px);transform:translateX(150px)}to{-webkit-transform:translateX(5px);transform:translateX(5px)}}.search-field,.search-placeholder{border:none;font-size:14px;height:40px;min-width:200px;outline:0;padding:0;width:100%}.search-placeholder{display:block}.search-field{display:none}.footer{background:#3367d6;font:400 13.3333px Arial;color:#fff;position:fixed;bottom:0}::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#20b2aa}"]
                }] },
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    EnterpriseGridComponent.ctorParameters = function () { return [
        { type: BaseActionDispatcher }
    ]; };
    EnterpriseGridComponent.propDecorators = {
        virtualScroll: [{ type: ViewChild, args: [CdkVirtualScrollViewport, { static: false },] }]
    };
    /** @nocollapse */ EnterpriseGridComponent.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function EnterpriseGridComponent_Factory() { return new EnterpriseGridComponent(i0.ɵɵinject(i1.BaseActionDispatcher)); }, token: EnterpriseGridComponent, providedIn: "root" });
    return EnterpriseGridComponent;
}());
export { EnterpriseGridComponent };
if (false) {
    /** @type {?} */
    EnterpriseGridComponent.prototype.gridConfig;
    /** @type {?} */
    EnterpriseGridComponent.prototype.columnConfig;
    /** @type {?} */
    EnterpriseGridComponent.prototype.gridDataList;
    /** @type {?} */
    EnterpriseGridComponent.prototype.gridHeader;
    /** @type {?} */
    EnterpriseGridComponent.prototype.addNewUserForm;
    /** @type {?} */
    EnterpriseGridComponent.prototype.enableActionToolbar;
    /** @type {?} */
    EnterpriseGridComponent.prototype.enableSearchToolBar;
    /** @type {?} */
    EnterpriseGridComponent.prototype.enableSearchPlaceholder;
    /** @type {?} */
    EnterpriseGridComponent.prototype.enableSearchBar;
    /** @type {?} */
    EnterpriseGridComponent.prototype.enableForm;
    /** @type {?} */
    EnterpriseGridComponent.prototype.enablePaging;
    /** @type {?} */
    EnterpriseGridComponent.prototype.row;
    /** @type {?} */
    EnterpriseGridComponent.prototype.cdkVirtualViewport;
    /** @type {?} */
    EnterpriseGridComponent.prototype.tdElement;
    /** @type {?} */
    EnterpriseGridComponent.prototype.thElement;
    /** @type {?} */
    EnterpriseGridComponent.prototype.filterValue;
    /** @type {?} */
    EnterpriseGridComponent.prototype.checkbox;
    /** @type {?} */
    EnterpriseGridComponent.prototype.virtualScroll;
    /**
     * @type {?}
     * @private
     */
    EnterpriseGridComponent.prototype.baseActionDispatcher;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW50ZXJwcmlzZS1ncmlkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2VudGVycHJpc2UtZ3JpZC8iLCJzb3VyY2VzIjpbImxpYi9lbnRlcnByaXNlLWdyaWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxVQUFVLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pFLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ2xFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLGdDQUFnQyxDQUFDOzs7QUFFdEU7SUFpQ0UsaUNBQW9CLG9CQUEwQztRQUExQyx5QkFBb0IsR0FBcEIsb0JBQW9CLENBQXNCO1FBdkI5RCxlQUFVLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQztRQUV6QixpQkFBWSxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7UUFDM0IsaUJBQVksR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQzNCLGVBQVUsR0FBVyxFQUFFLENBQUM7UUFFeEIsbUJBQWMsR0FBRyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQzlDLHdCQUFtQixHQUFHLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDbkQsd0JBQW1CLEdBQUcsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNuRCw0QkFBdUIsR0FBRyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ3hELG9CQUFlLEdBQUcsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNoRCxlQUFVLEdBQUcsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUMxQyxpQkFBWSxHQUFZLEtBQUssQ0FBQztJQVdtQyxDQUFDOzs7O0lBRWxFLDBDQUFROzs7SUFBUjtRQUNFLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxzQkFBSSxnREFBVzs7Ozs7UUFBZixVQUFnQixJQUFJO1lBQ2xCLElBQUksQ0FBQyxZQUFZLEdBQUMsSUFBSSxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNsQixPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQztRQUNuRSxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLGtEQUFhOzs7OztRQUFqQixVQUFrQixJQUFJO1lBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLGtDQUFrQyxDQUFDLENBQUM7WUFDdEQsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUIsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFN0IsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDdkMsQ0FBQzs7O09BQUE7SUFFRDs7O09BR0c7Ozs7OztJQUNILGdEQUFjOzs7OztJQUFkLFVBQWUsVUFBVTs7WUFDbkIsSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDOztZQUM5QixrQkFBa0IsR0FBRyxNQUFNLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDO1FBRXpELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ3BDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxrQkFBa0IsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ2xELElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxFQUFFO29CQUNyQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUMzRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2lCQUMxRTthQUNGO1NBQ0Y7SUFDSCxDQUFDOzs7O0lBRUQsa0RBQWdCOzs7SUFBaEI7O1lBQ1EsS0FBSyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU07UUFDNUMsc0JBQXNCO1FBQ3RCLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVELHVDQUF1Qzs7Ozs7SUFDdkMsNENBQVU7Ozs7SUFBVjtRQUNFLElBQUksQ0FBQyxHQUFHLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4QyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsT0FBTyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7UUFDL0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDekMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ3BCLENBQUM7SUFFRCx3Q0FBd0M7Ozs7O0lBRXhDLDRDQUFVOzs7O0lBQVY7UUFDRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDakQsSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUM7WUFDekMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsYUFBYSxHQUFHLE1BQU0sQ0FBQztZQUM1QyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1lBQ3RDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUM7WUFDeEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsWUFBWSxHQUFHLGdCQUFnQixDQUFDO1lBQ3JELElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyx5QkFBeUIsQ0FBQztZQUM1RCxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1lBQ3JDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7WUFDdEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztZQUNyQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsR0FBRyxDQUFDO1lBQzNELElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUN0QztJQUVILENBQUM7SUFFRDs7T0FFRzs7Ozs7SUFDSCxvREFBa0I7Ozs7SUFBbEI7O1lBQ1EsWUFBWSxHQUFHLG1CQUFBLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBZTtRQUVoRixJQUFJLFlBQVksQ0FBQyxpQkFBaUIsSUFBSSxDQUFDLEVBQUU7WUFDdkMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUNqRCxJQUFJLENBQUMsU0FBUyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBRTlDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7Z0JBQ3RDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUM7Z0JBQ3hDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFlBQVksR0FBRyxnQkFBZ0IsQ0FBQztnQkFDckQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsVUFBVSxHQUFHLHlCQUF5QixDQUFDO2dCQUM1RCxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO2dCQUNyQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO2dCQUN0QyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDO2dCQUN2QyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO2dCQUMzQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO2dCQUNyQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsaUJBQWlCLENBQUM7Z0JBQy9DLHdDQUF3QztnQkFDeEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEdBQUcsQ0FBQztnQkFFM0QsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxVQUFVLEVBQUU7b0JBQzVDLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDdEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztvQkFDdEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2lCQUMzQztxQkFBTTs7d0JBQ0MsUUFBUSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSTtvQkFDMUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7b0JBQ3JELElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztpQkFDeEM7Z0JBRUQsWUFBWSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7YUFDMUM7U0FDRjtJQUNILENBQUM7Ozs7SUFFRCxnREFBYzs7O0lBQWQ7UUFDRSxJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDaEQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBRS9DLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN4QyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsb0ZBQW9GLENBQUM7UUFDdEgsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQztRQUN2QyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ3BDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7UUFDbkMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztRQUNuQyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDO0lBQzFDLENBQUM7SUFFRCw2RkFBNkY7Ozs7O0lBQzdGLDRDQUFVOzs7O0lBQVY7UUFDRSxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQzNCLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxRQUFRLENBQUMsc0JBQXNCLENBQUMsb0NBQW9DLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxjQUFjLENBQUM7UUFFdkQsc0JBQXNCO1FBQ3RCLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBRTFCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUVqRCxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDbEIsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBRXRCLEtBQUssSUFBSSxhQUFhLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDOUMsS0FBSyxJQUFJLGVBQWUsSUFBSSxJQUFJLENBQUMsWUFBWSxFQUFFO29CQUM3QyxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxLQUFLLGFBQWEsRUFBRTs7NEJBQ3pELEtBQUssR0FBRyxRQUFRLENBQUMsc0JBQXNCLENBQUMsZ0JBQWdCLENBQUM7OzRCQUV6RCxZQUFZLEdBQUcsS0FBSyxDQUFDLE1BQU07OzRCQUUzQixZQUFZLEdBQUcsbUJBQUEsUUFBUSxDQUFDLHNCQUFzQixDQUFDLGdCQUFnQixDQUFDLENBQUMsWUFBWSxHQUFHLENBQUMsQ0FBQyxFQUF1Qjs7NEJBRXpHLGFBQWEsR0FBRyxZQUFZLENBQUMsS0FBSzs7NEJBRWxDLEdBQUcsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLGVBQWUsQ0FBQyxDQUFDLFFBQVE7OzRCQUVqRCxLQUFLLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUM7d0JBRS9DLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3dCQUU1QyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztxQkFDdEM7aUJBQ0Y7YUFDRjtTQUNGO0lBQ0gsQ0FBQztJQUVEOztPQUVHOzs7Ozs7O0lBQ0gsOENBQVk7Ozs7OztJQUFaLFVBQWEsSUFBSTtRQUVmLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO1FBQ3ZCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNqRCxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDakQsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQzlDO1NBQ0Y7SUFDSCxDQUFDOzs7OztJQUVELHNEQUFvQjs7OztJQUFwQixVQUFxQixDQUFDO1FBRXBCLElBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUU7U0FFM0Q7SUFDSCxDQUFDO0lBRUQ7O09BRUc7Ozs7OztJQUNILHNEQUFvQjs7Ozs7SUFBcEIsVUFBcUIsS0FBSztRQUN4QixJQUFJLENBQUMsb0JBQW9CLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFRCxxRkFBcUY7Ozs7OztJQUNyRixtREFBaUI7Ozs7O0lBQWpCLFVBQWtCLE1BQU07UUFDdEIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNuRCxDQUFDOztnQkFuT0YsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxvQkFBb0I7b0JBQzlCLGlrRUFBK0M7O2lCQUVoRDtnQkFDQSxVQUFVLFNBQUM7b0JBQ1YsVUFBVSxFQUFFLE1BQU07aUJBQ25COzs7O2dCQVRRLG9CQUFvQjs7O2dDQWlDMUIsU0FBUyxTQUFDLHdCQUF3QixFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRTs7O2tDQW5DeEQ7Q0F3T0MsQUFwT0QsSUFvT0M7U0E1TlksdUJBQXVCOzs7SUFFbEMsNkNBQXlCOztJQUV6QiwrQ0FBMkI7O0lBQzNCLCtDQUEyQjs7SUFDM0IsNkNBQXdCOztJQUV4QixpREFBOEM7O0lBQzlDLHNEQUFtRDs7SUFDbkQsc0RBQW1EOztJQUNuRCwwREFBd0Q7O0lBQ3hELGtEQUFnRDs7SUFDaEQsNkNBQTBDOztJQUMxQywrQ0FBOEI7O0lBRTlCLHNDQUF5Qjs7SUFDekIscURBQW1COztJQUNuQiw0Q0FBZ0M7O0lBQ2hDLDRDQUFzQzs7SUFDdEMsOENBQVk7O0lBQ1osMkNBQVM7O0lBRVQsZ0RBQWdHOzs7OztJQUVwRix1REFBa0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5qZWN0YWJsZSwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENka1ZpcnR1YWxTY3JvbGxWaWV3cG9ydCB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9zY3JvbGxpbmcnO1xyXG5pbXBvcnQgeyBCYXNlQWN0aW9uRGlzcGF0Y2hlciB9IGZyb20gJy4uL2FjdGlvbi9CYXNlQWN0aW9uRGlzcGF0Y2hlcic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2FvLWVudGVycHJpc2UtZ3JpZCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2VudGVycHJpc2UtZ3JpZC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vZW50ZXJwcmlzZS1ncmlkLmNvbXBvbmVudC5zY3NzJ10sXHJcbn0pXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIEVudGVycHJpc2VHcmlkQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgZ3JpZENvbmZpZyA9IG5ldyBBcnJheSgpO1xyXG5cclxuICBjb2x1bW5Db25maWcgPSBuZXcgQXJyYXkoKTtcclxuICBncmlkRGF0YUxpc3QgPSBuZXcgQXJyYXkoKTtcclxuICBncmlkSGVhZGVyOiBzdHJpbmcgPSAnJztcclxuXHJcbiAgYWRkTmV3VXNlckZvcm0gPSB7IGVuYWJsZTogZmFsc2UsIHRva2VuOiAnJyB9O1xyXG4gIGVuYWJsZUFjdGlvblRvb2xiYXIgPSB7IGVuYWJsZTogZmFsc2UsIHRva2VuOiAnJyB9O1xyXG4gIGVuYWJsZVNlYXJjaFRvb2xCYXIgPSB7IGVuYWJsZTogZmFsc2UsIHRva2VuOiAnJyB9O1xyXG4gIGVuYWJsZVNlYXJjaFBsYWNlaG9sZGVyID0geyBlbmFibGU6ICdub25lJywgdG9rZW46ICcnIH07XHJcbiAgZW5hYmxlU2VhcmNoQmFyID0geyBlbmFibGU6ICdub25lJywgdG9rZW46ICcnIH07XHJcbiAgZW5hYmxlRm9ybSA9IHsgZW5hYmxlOiBmYWxzZSwgdG9rZW46ICcnIH07XHJcbiAgZW5hYmxlUGFnaW5nOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIHJvdzogSFRNTFRhYmxlUm93RWxlbWVudDtcclxuICBjZGtWaXJ0dWFsVmlld3BvcnQ7XHJcbiAgdGRFbGVtZW50OiBIVE1MVGFibGVDZWxsRWxlbWVudDtcclxuICB0aEVsZW1lbnQ6IEhUTUxUYWJsZUhlYWRlckNlbGxFbGVtZW50O1xyXG4gIGZpbHRlclZhbHVlO1xyXG4gIGNoZWNrYm94O1xyXG5cclxuICBAVmlld0NoaWxkKENka1ZpcnR1YWxTY3JvbGxWaWV3cG9ydCwgeyBzdGF0aWM6IGZhbHNlIH0pIHZpcnR1YWxTY3JvbGw6IENka1ZpcnR1YWxTY3JvbGxWaWV3cG9ydDtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBiYXNlQWN0aW9uRGlzcGF0Y2hlcjogQmFzZUFjdGlvbkRpc3BhdGNoZXIpIHt9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5jb2x1bW5Db25maWcgPSBbXTtcclxuICB9XHJcblxyXG4gIHNldCBzZXRHcmlkRGF0YShkYXRhKSB7XHJcbiAgICB0aGlzLmdyaWREYXRhTGlzdD1kYXRhO1xyXG4gICAgdGhpcy5jcmVhdGVHcmlkKCk7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLmdyaWREYXRhTGlzdCwgJyBlbnRlcnByaXNlIGdyaWQgbGlzdCByZWNlaXZlZCcpO1xyXG4gIH1cclxuXHJcbiAgc2V0IHNldEdyaWRDb25maWcoZGF0YSkge1xyXG4gICAgY29uc29sZS5sb2coZGF0YSwgJyBlbnRlcnByaXNlIGdyaWQgY29uZmlnIHJlY2VpdmVkJyk7XHJcbiAgICB0aGlzLmdyaWRIZWFkZXIgPSBkYXRhWzBdO1xyXG4gICAgdGhpcy5jb2x1bW5Db25maWcgPSBkYXRhWzFdO1xyXG4gICAgdGhpcy5ncmlkQ29uZmlnID0gZGF0YVsyXVswXTtcclxuXHJcbiAgICB0aGlzLnNvcnRHcmlkQ29uZmlnKHRoaXMuZ3JpZENvbmZpZyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCBzb3J0cyB0aGUgZ3JpZCBjb25maWd1cmF0aW9uLlxyXG4gICAqIEBwYXJhbSBncmlkQ29uZmlnIEpTT04gb2JqZWN0IG9mIGdyaWQgY29uZmlndXJhdGlvbi5cclxuICAgKi9cclxuICBzb3J0R3JpZENvbmZpZyhncmlkQ29uZmlnKSB7XHJcbiAgICBsZXQga2V5cyA9IE9iamVjdC5rZXlzKGdyaWRDb25maWcpO1xyXG4gICAgbGV0IGVudGVycEdyaWRDb21wS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpO1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGVudGVycEdyaWRDb21wS2V5cy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgIGlmIChrZXlzW2ldID09PSBlbnRlcnBHcmlkQ29tcEtleXNbal0pIHtcclxuICAgICAgICAgIHRoaXNbZW50ZXJwR3JpZENvbXBLZXlzW2pdXVsnZW5hYmxlJ10gPSB0aGlzLmdyaWRDb25maWdba2V5c1tpXV1bJ2VuYWJsZSddO1xyXG4gICAgICAgICAgdGhpc1tlbnRlcnBHcmlkQ29tcEtleXNbal1dWyd0b2tlbiddID0gdGhpcy5ncmlkQ29uZmlnW2tleXNbaV1dWyd0b2tlbiddO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0V2lkdGhCeUNvbHVtbigpOiBudW1iZXIge1xyXG4gICAgY29uc3QgY291bnQgPSAxMDAgLyB0aGlzLmNvbHVtbkNvbmZpZy5sZW5ndGg7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhjb3VudCk7XHJcbiAgICByZXR1cm4gY291bnQ7XHJcbiAgfVxyXG5cclxuICAvKiogQ3JlYXRlcyBncmlkIHJvd3MgYW5kIGFkZCBzdHlsZXMgKi9cclxuICBjcmVhdGVSb3dzKCkge1xyXG4gICAgdGhpcy5yb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xyXG4gICAgdGhpcy5yb3cuc3R5bGUuYmFja2dyb3VuZCA9ICd3aGl0ZSc7XHJcbiAgICB0aGlzLnJvdy5zdHlsZS5wYWRkaW5nID0gJzVweCc7XHJcbiAgICB0aGlzLnJvdy5jbGFzc0xpc3QuYWRkKFwidGFibGUtcm93LWRhdGFcIik7XHJcbiAgICB0aGlzLmNka1ZpcnR1YWxWaWV3cG9ydC5hcHBlbmRDaGlsZCh0aGlzLnJvdyk7XHJcbiAgICB0aGlzLnN0eWxlQ2VsbHMoKTtcclxuICB9XHJcblxyXG4gIC8qKiBDcmVhdGVzIGdyaWQgY2VsbHMgYW5kIGFkZCBzdHlsZXMgKi9cclxuXHJcbiAgc3R5bGVDZWxscygpIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jb2x1bW5Db25maWcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdGhpcy50ZEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgICB0aGlzLnRkRWxlbWVudC5zdHlsZS5wYWRkaW5nVG9wID0gJzEwcHgnO1xyXG4gICAgICB0aGlzLnRkRWxlbWVudC5zdHlsZS5wYWRkaW5nQm90dG9tID0gJzEwcHgnO1xyXG4gICAgICB0aGlzLnRkRWxlbWVudC5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xyXG4gICAgICB0aGlzLnRkRWxlbWVudC5zdHlsZS50ZXh0QWxpZ24gPSAnbGVmdCc7XHJcbiAgICAgIHRoaXMudGRFbGVtZW50LnN0eWxlLmJvcmRlckJvdHRvbSA9ICcxcHggc29saWQgI2RkZCc7XHJcbiAgICAgIHRoaXMudGRFbGVtZW50LnN0eWxlLmZvbnRGYW1pbHkgPSAnXCJRdWVzdHJpYWxcIiwgc2Fucy1zZXJpZic7XHJcbiAgICAgIHRoaXMudGRFbGVtZW50LnN0eWxlLmJvcmRlciA9ICdub25lJztcclxuICAgICAgdGhpcy50ZEVsZW1lbnQuc3R5bGUub3V0bGluZSA9ICdub25lJztcclxuICAgICAgdGhpcy50ZEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzM5cHgnO1xyXG4gICAgICB0aGlzLnRkRWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMuc2V0V2lkdGhCeUNvbHVtbigpICsgJyUnO1xyXG4gICAgICB0aGlzLnJvdy5hcHBlbmRDaGlsZCh0aGlzLnRkRWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIHRhYmxlIGhlYWRpbmdcclxuICAgKi9cclxuICBjcmVhdGVUYWJsZUhlYWRpbmcoKTogdm9pZCB7XHJcbiAgICBjb25zdCB0YWJsZUhlYWREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidGgtZGl2XCIpWzBdIGFzIEhUTUxFbGVtZW50O1xyXG5cclxuICAgIGlmICh0YWJsZUhlYWREaXYuY2hpbGRFbGVtZW50Q291bnQgPT0gMCkge1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY29sdW1uQ29uZmlnLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGhpcy50aEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xyXG5cclxuICAgICAgICB0aGlzLnRoRWxlbWVudC5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xyXG4gICAgICAgIHRoaXMudGhFbGVtZW50LnN0eWxlLnRleHRBbGlnbiA9ICdsZWZ0JztcclxuICAgICAgICB0aGlzLnRoRWxlbWVudC5zdHlsZS5ib3JkZXJCb3R0b20gPSAnMXB4IHNvbGlkICNkZGQnO1xyXG4gICAgICAgIHRoaXMudGhFbGVtZW50LnN0eWxlLmZvbnRGYW1pbHkgPSAnXCJRdWVzdHJpYWxcIiwgc2Fucy1zZXJpZic7XHJcbiAgICAgICAgdGhpcy50aEVsZW1lbnQuc3R5bGUuYm9yZGVyID0gJ25vbmUnO1xyXG4gICAgICAgIHRoaXMudGhFbGVtZW50LnN0eWxlLm91dGxpbmUgPSAnbm9uZSc7XHJcbiAgICAgICAgdGhpcy50aEVsZW1lbnQuc3R5bGUuZm9udFNpemUgPSAnMTRweCc7XHJcbiAgICAgICAgdGhpcy50aEVsZW1lbnQuc3R5bGUubGV0dGVyU3BhY2luZyA9ICcxcHgnO1xyXG4gICAgICAgIHRoaXMudGhFbGVtZW50LnN0eWxlLmhlaWdodCA9ICcxNnB4JztcclxuICAgICAgICB0aGlzLnRoRWxlbWVudC5zdHlsZS5jb2xvciA9ICdyZ2JhKDAsMCwwLC41NCknO1xyXG4gICAgICAgIC8vIHRoaXMudGhFbGVtZW50LndoaXRlU3BhY2UgPSAnbm93cmFwJztcclxuICAgICAgICB0aGlzLnRoRWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMuc2V0V2lkdGhCeUNvbHVtbigpICsgJyUnO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5jb2x1bW5Db25maWdbaV0ubmFtZSA9PT0gJ2NoZWNrYm94Jykge1xyXG4gICAgICAgICAgdGhpcy5jcmVhdGVDaGVja2JveCgpO1xyXG4gICAgICAgICAgdGhpcy5jaGVja2JveC5zdHlsZS5tYXJnaW5Ub3AgPSAnMHB4JztcclxuICAgICAgICAgIHRoaXMudGhFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuY2hlY2tib3gpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zdCBoZWFkTmFtZSA9IHRoaXMuY29sdW1uQ29uZmlnW2ldLm5hbWU7XHJcbiAgICAgICAgICB0aGlzLnRoRWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLmNvbHVtbkNvbmZpZ1tpXS5pdGVtO1xyXG4gICAgICAgICAgdGhpcy50aEVsZW1lbnQuY2xhc3NMaXN0LmFkZChoZWFkTmFtZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0YWJsZUhlYWREaXYuYXBwZW5kQ2hpbGQodGhpcy50aEVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjcmVhdGVDaGVja2JveCgpIHtcclxuICAgIHRoaXMuY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiSU5QVVRcIik7XHJcbiAgICB0aGlzLmNoZWNrYm94LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJjaGVja2JveFwiKTtcclxuXHJcbiAgICB0aGlzLmNoZWNrYm94LmNsYXNzTGlzdC5hZGQoJ2NoZWNrYm94Jyk7XHJcbiAgICB0aGlzLmNoZWNrYm94LnN0eWxlLnRyYW5zaXRpb24gPSAnYmFja2dyb3VuZCAuNHMgY3ViaWMtYmV6aWVyKC4yNSwuOCwuMjUsMSksYm94LXNoYWRvdyAyODBtcyBjdWJpYy1iZXppZXIoLjQsMCwuMiwxKSc7XHJcbiAgICB0aGlzLmNoZWNrYm94LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgIHRoaXMuY2hlY2tib3guc3R5bGUuaGVpZ2h0ID0gJzE2cHgnO1xyXG4gICAgdGhpcy5jaGVja2JveC5zdHlsZS5tYXJnaW4gPSAnNnB4JztcclxuICAgIHRoaXMuY2hlY2tib3guc3R5bGUud2lkdGggPSAnMTZweCc7XHJcbiAgICB0aGlzLmNoZWNrYm94LnN0eWxlLm1hcmdpbkxlZnQgPSAnMTdweCc7XHJcbiAgfVxyXG5cclxuICAvKiogQ3JlYXRlcyB0aGUgcm93cyBhbmQgY29sdW1ucyBvZiB0aGUgZ3JpZCBhY2NvcmRpbmcgdG8gY29sdW1uIGRlZnMgYW5kIG1vZHVsZSBkYXRhIGxpc3QgKi9cclxuICBjcmVhdGVHcmlkKCkge1xyXG4gICAgY29uc29sZS5sb2coJ2NyZWF0ZSBncmlkJyk7XHJcbiAgICB0aGlzLmNka1ZpcnR1YWxWaWV3cG9ydCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Nkay12aXJ0dWFsLXNjcm9sbC1jb250ZW50LXdyYXBwZXInKVswXTtcclxuICAgIHRoaXMuY2RrVmlydHVhbFZpZXdwb3J0LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLXRhYmxlJztcclxuXHJcbiAgICAvL0NyZWF0ZSB0YWJsZSBoZWFkaW5nXHJcbiAgICB0aGlzLmNyZWF0ZVRhYmxlSGVhZGluZygpO1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5ncmlkRGF0YUxpc3QubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgIHRoaXMuY3JlYXRlUm93cygpO1xyXG4gICAgICB0aGlzLmNyZWF0ZUNoZWNrYm94KCk7XHJcblxyXG4gICAgICBmb3IgKGxldCBtb2R1bGVMaXN0S2V5IGluIHRoaXMuZ3JpZERhdGFMaXN0W2ldKSB7XHJcbiAgICAgICAgZm9yIChsZXQgY29sdW1uQ29uZmlnS2V5IGluIHRoaXMuY29sdW1uQ29uZmlnKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5jb2x1bW5Db25maWdbY29sdW1uQ29uZmlnS2V5XS5uYW1lID09PSBtb2R1bGVMaXN0S2V5KSB7XHJcbiAgICAgICAgICAgIHZhciB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJsZS1yb3ctZGF0YVwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBsYXN0Um93SW5kZXggPSB0YWJsZS5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICBsZXQgdGFibGVSb3dEYXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGFibGUtcm93LWRhdGEnKVtsYXN0Um93SW5kZXggLSAxXSBhcyBIVE1MVGFibGVSb3dFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgbGV0IHRhYmxlRGF0YUNlbGwgPSB0YWJsZVJvd0RhdGEuY2VsbHM7XHJcblxyXG4gICAgICAgICAgICBsZXQgcG9zID0gdGhpcy5jb2x1bW5Db25maWdbY29sdW1uQ29uZmlnS2V5XS5wb3NpdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IHRoaXMuZ3JpZERhdGFMaXN0W2ldW21vZHVsZUxpc3RLZXldO1xyXG5cclxuICAgICAgICAgICAgdGFibGVEYXRhQ2VsbFswXS5hcHBlbmRDaGlsZCh0aGlzLmNoZWNrYm94KTtcclxuXHJcbiAgICAgICAgICAgIHRhYmxlRGF0YUNlbGxbcG9zXS5pbm5lckhUTUwgPSB2YWx1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKiBTZWFyY2ggZmlsdGVyYXRpb24gYnkgbmFtZVxyXG4gICAqICAoU3RpbGwgaW4gcHJvZ3Jlc3MpXHJcbiAgICovXHJcbiAgc2VhcmNoQnlOYW1lKGRhdGEpIHtcclxuXHJcbiAgICB0aGlzLmdyaWREYXRhTGlzdCA9IFtdO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmdyaWREYXRhTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAodGhpcy5ncmlkRGF0YUxpc3RbaV0uZmlyc3ROYW1lLmluY2x1ZGVzKGRhdGEpKSB7XHJcbiAgICAgICAgdGhpcy5ncmlkRGF0YUxpc3QucHVzaCh0aGlzLmdyaWREYXRhTGlzdFtpXSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldE5leHRCYXRjaE9mSW1hZ2VzKGEpIHtcclxuXHJcbiAgICBpZiAodGhpcy52aXJ0dWFsU2Nyb2xsLm1lYXN1cmVTY3JvbGxPZmZzZXQoJ2JvdHRvbScpID09PSAwKSB7XHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRm9yd2FyZCB0aGUgZXZlbnQgdG8gZGlzcGF0Y2ggYWN0aW9uIHdpdGggdG9rZW5zIGFuZCBwYXJhbWV0ZXJzLlxyXG4gICAqL1xyXG4gIGFkZE5ld1VzZXJGb3JtQWN0aW9uKHRva2VuKTogdm9pZCB7XHJcbiAgICB0aGlzLmJhc2VBY3Rpb25EaXNwYXRjaGVyLmRpc3BhdGNoQWN0aW9uKHRva2VuKTtcclxuICB9XHJcblxyXG4gIC8qKiBUb2dnbGVzIGZyb20gc2VhcmNoIHBsYWNlaG9sZGVyIHRvIHNlYXJjaCBiYXIvYm94IGJ5IHNldHRpbmcgdGhlIGRpc3BsYXkgdmFsdWUgKi9cclxuICB0b2dnbGVUb1NlYXJjaEJhcihhY3Rpb24pIHtcclxuICAgIHRoaXMuYmFzZUFjdGlvbkRpc3BhdGNoZXIuZGlzcGF0Y2hBY3Rpb24oYWN0aW9uKTtcclxuICB9XHJcbn1cclxuIl19